On Site

(pick one or more)

DAU / MAU, Last Action, Date List (question)  <-- BROKEN LINK!
Implement DQ checks that ensure that the data you are loading it correct
Rolling Visits - determine the number of people who have visited in the last 7 days, every day
How do you fix duplicated rows in a table?
A query you wrote a year ago, suddenly started taking >24 hours. What do you do to diagnose?
You are given three tables a) Account which contains Account id b) Date That contains dateid c) Sales Fact with three columns date, Account Id and revenue . This fact records the revenue generated by an account every day if they spend. If there is no spend then there won't be a record in the fact table . Given this scenario write an SOL that generates a list of all Accounts on every day in the last one Month that had no spent.
The Question #1 above requires a cross join with Accounts and Dates and lead to a large table if your account dimension is big. How could you optimize this from a design perspective? => Answer could be datelist, bitmap integer etc.
Given a Table with Account and Revenue for a month find the Max and Second Max Revenue from that table without using MAX function. Also any windowing functions (like Lead/Lag/Rank/Row Number) are not allowed. Rowid/ rownum/limit. not allowed as well. You can use joins, filter conditions, Group By /Order by  => This tests self join to count records that are greater than each record. 
Given a Table with dateid, Pageid, Number of Actions . Write a SQL that calculates the total number of actions for a pageid and dateid in last 1,7 and 28 days => One implementation is date or dateint and action each day. Or just array with actions for each day etc.
